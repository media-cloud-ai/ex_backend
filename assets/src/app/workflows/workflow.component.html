<div class="workflow">
  <div *ngIf="workflow" class="info">
    <i class="material-icons open"
      *ngIf=!detailed
      (click)=switchDetailed()>
      expand_more
    </i>
    <i class="material-icons close"
      *ngIf=detailed
      (click)=switchDetailed()>
      expand_less
    </i>

    <span class="identifier">#{{ workflow.id }}</span>
    <span class="reference">
      <video-title-component [id]=workflow.reference></video-title-component>
      <span class="badge-live" *ngIf=workflow.is_live>
        LIVE
      </span>
    </span>
    <span class="created">
      <label>
        Created at
      </label>
      <span class="date">
        {{workflow.created_at | date: 'd LLLL yy'}}
      </span>
      <span class="hour">
        {{workflow.created_at+'Z' | date: 'HH:mm:ss'}}
      </span>
    </span>
    <span class="duration">
      <duration-component [workflow]=workflow display="simple"></duration-component>
    </span>
    <span class="user">
      {{workflow.user_uuid}}
    </span>
    <span class="steps-count">
      <span class="label">Steps:</span>
      <span class="count">{{getStepsCount()}} / {{getTotalSteps()}}</span>
    </span>
    <span class="details">
      <button
        mat-raised-button
        color="primary"
        >
        <a routerLink="/workflows/{{workflow.id}}">
          <mat-icon>visibility</mat-icon>
          Details
        </a>
      </button>
    </span>
    <span
      class="pause"
      *ngIf="!can_resume">
      <button
        mat-raised-button
        color="primary"
        [disabled]=!can_pause
        (click)="pause(workflow.id)"
        >
        <mat-icon>pause</mat-icon>
        Pause
      </button>
    </span>
    <span
      class="resume"
      *ngIf="!can_pause && can_resume">
      <button
        mat-raised-button
        color="primary"
        (click)="resume(workflow.id)"
        >
        <mat-icon>play_arrow</mat-icon>
        Resume
      </button>
    </span>
    <span
      class="abort" *ngIf=!workflow.is_live>
      <button
        mat-raised-button
        color="warn"
        [disabled]=!can_abort
        (click)="abort(workflow.id)"
        *ngIf="right_abort"
        >
        <mat-icon>cancel</mat-icon>
        Abort
      </button>
    </span>
    <span
      class="stop" *ngIf=workflow.is_live>
      <button
        mat-raised-button
        color="warn"
        [disabled]=!can_stop
        (click)="stop(workflow.id)"
        >
        <mat-icon>stop</mat-icon>
        Stop
      </button>
    </span>
    <span
      class="delete">
      <button
        mat-raised-button
        color="warn"
        (click)="delete(workflow.id)"
        *ngIf="right_delete"
        >
        <mat-icon>delete_forever</mat-icon>
      </button>
    </span>
  </div>
  <div *ngIf="workflow" class=steps>
    <div
      *ngFor="let step of workflow.steps"
      class="step {{step.name}} {{step.status}}">
      <step-progress-bar-component
        [step]=step
        [workflow]=workflow
        [detailed]=detailed>
      </step-progress-bar-component>
    </div>
  </div>
</div>
